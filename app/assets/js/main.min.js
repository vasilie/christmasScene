function changeTexture(){currentTexture++,currentTexture%=textures.length,mainTexture=textures[currentTexture],mesh.material.map=THREE.ImageUtils.loadTexture("assets/textures/"+mainTexture)}function render(){clock.getElapsedTime();floor.visible=!0,floor.visible=!1,mirrorCamera.position.copy(floor.position),mirrorCamera.rotation.set(0,0,0),groundMirror.updateTextureMatrix(),groundMirror.render(),renderer.render(scene,camera),requestAnimationFrame(render)}var container,scene,renderer,camera,light,clock,loader,WIDTH,HEIGHT,VIEW_ANGLE,ASPECT,NEAR,FAR;container=document.querySelector(".viewport"),clock=new THREE.Clock,WIDTH=window.innerWidth,HEIGHT=window.innerHeight,VIEW_ANGLE=45,ASPECT=WIDTH/HEIGHT,NEAR=1,FAR=1e4,scene=new THREE.Scene,scene.rotation.x=0,scene.rotation.y=0,scene.rotation.z=0,renderer=new THREE.WebGLRenderer({antialias:!0}),renderer.setSize(WIDTH,HEIGHT),renderer.shadowMapEnabled=!0,renderer.shadowMapSoft=!0,renderer.shadowMapType=THREE.PCFShadowMap,renderer.shadowMapAutoUpdate=!0,renderer.setClearColor(16777215,1),container.appendChild(renderer.domElement),camera=new THREE.PerspectiveCamera(VIEW_ANGLE,ASPECT,NEAR,FAR),mirrorCamera=new THREE.CubeCamera(1,10,1024),camera.position.set(0,2,7),camera.rotation.x=-Math.PI/12,scene.add(camera),controls=new THREE.OrbitControls(camera,renderer.domElement),controls.target.set(0,0,0),controls.update(),light=new THREE.DirectionalLight(16777215),light.intensity=.17,light.position.set(100,100,-150),light.castShadow=!0,light.shadowCameraLeft=-3,light.shadowCameraTop=-3,light.shadowCameraRight=2,light.shadowCameraBottom=2,light.shadowCameraNear=1,light.shadowCameraFar=400,light.shadowBias=-1e-4,light.shadowMapWidth=light.shadowMapHeight=1024,light.shadowDarkness=.001;var ambient=new THREE.AmbientLight(16777215),point=new THREE.PointLight(16777215,.3,1e3);point.shadowCameraLeft=-2,point.shadowCameraTop=-2,point.shadowCameraRight=2,point.shadowCameraBottom=2,point.shadowCameraNear=1,point.shadowCameraFar=1e3,point.shadowBias=-1e-4,point.shadowMapWidth=point.shadowMapHeight=256,point.shadowDarkness=.001,ambient.intensity=.9,scene.add(light),scene.add(ambient,point),point.position.x=1,point.position.y=3,point.position.z=5,loader=new THREE.JSONLoader,scene.add(mirrorCamera);var mesh,container,maxAnisotropy=renderer.getMaxAnisotropy(),floor_geometry=new THREE.BoxGeometry(10,.001,10),floor_material=new THREE.MeshBasicMaterial({envMap:mirrorCamera.renderTarget}),planeGeo=new THREE.PlaneBufferGeometry(100.1,100.1),groundMirror=new THREE.Mirror(renderer,camera,{clipBias:1,textureWidth:WIDTH,textureHeight:HEIGHT,color:15527148}),texture=groundMirror.material;texture.anisotropy=maxAnisotropy;var mirrorMesh=new THREE.Mesh(planeGeo,texture);mirrorMesh.add(groundMirror),mirrorMesh.rotateX(-Math.PI/2),scene.add(mirrorMesh);var currentTexture=0,textures=["black.jpg","silver.jpg","abstract.jpg","wall.jpg","metal.jpg","wood.jpg","blood.jpg","blue.jpg","mermer.jpg","minecraft.png","second.jpg","greenmarble.jpg","first.jpg","musema.jpg"],mainTexture=textures[currentTexture];texture.needsUpdate=!0,loader.load("assets/models/stand.json",function(e,r){var a=new THREE.MeshLambertMaterial({map:THREE.ImageUtils.loadTexture("assets/textures/"+mainTexture)});mesh=new THREE.Mesh(e,a),scene.add(mesh),floor=new THREE.Mesh(floor_geometry,floor_material),mirrorCamera.position=floor.position,camera.position.z=15,floor.receiveShadow=!0,camera.lookAt(0,0,0),mesh.receiveShadow=!0,mesh.castShadow=!0,mesh.rotation.z=0,mesh.rotation.x=Math.PI/2,mesh.rotation.y=0,mesh.position.x=-1,mesh.position.z=-1,scene.add(floor),scene.fog=new THREE.FogExp2(10066431,25e-5),render()});