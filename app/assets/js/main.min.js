function changeTexture(){if(arguments.length>0)switch(arguments[0]){case"black":currentTexture=0;break;case"white":currentTexture=8;break;case"silver":currentTexture=1}else currentTexture++,currentTexture%=textures.length;console.log(arguments),mainTexture=textures[currentTexture],mesh.material.map=THREE.ImageUtils.loadTexture("assets/textures/"+mainTexture)}function render(){var time=clock.getElapsedTime();floor.visible=!0,floor.visible=!1,mirrorCamera.position.copy(floor.position),mirrorCamera.rotation.set(0,0,0);for(var i=0;i<particles.length;i++){var particle=particles[i];with(particle.updatePhysics(),particle.position)y<-1&&(y+=10),x>10?x-=20:x<-10&&(x+=20),z>10?z-=20:z<-10&&(z+=20)}groundMirror.updateTextureMatrix(),groundMirror.render(),renderer.render(scene,camera),requestAnimationFrame(render)}var container,scene,renderer,camera,light,clock,loader,WIDTH,HEIGHT,VIEW_ANGLE,ASPECT,NEAR,FAR;container=document.querySelector(".viewport");var particles=[];clock=new THREE.Clock,WIDTH=window.innerWidth,HEIGHT=window.innerHeight,VIEW_ANGLE=45,ASPECT=WIDTH/HEIGHT,NEAR=1,FAR=1e4,scene=new THREE.Scene,scene.rotation.x=0,scene.rotation.y=0,scene.rotation.z=0,renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),renderer.setSize(WIDTH,HEIGHT),renderer.shadowMapEnabled=!0,renderer.shadowMapSoft=!0,renderer.shadowMapType=THREE.PCFShadowMap,renderer.shadowMapAutoUpdate=!0,renderer.setClearColor(2236962,1),container.appendChild(renderer.domElement),camera=new THREE.PerspectiveCamera(VIEW_ANGLE,ASPECT,NEAR,FAR),mirrorCamera=new THREE.CubeCamera(1,10,1024),camera.position.set(7.59195005741784,1.4453954384859604,3.6399825559441346),camera.rotation.x=-Math.PI/12,scene.add(camera),controls=new THREE.OrbitControls(camera,renderer.domElement),controls.target.set(0,0,0),controls.update(),controls.maxPolarAngle=Math.PI/2-.094,controls.enablePan=!1,controls.maxDistance=13,controls.minDistance=5.5,light=new THREE.DirectionalLight(16777215),light.intensity=.17,light.position.set(100,100,-150),light.castShadow=!0,light.shadowCameraLeft=-3,light.shadowCameraTop=-3,light.shadowCameraRight=2,light.shadowCameraBottom=2,light.shadowCameraNear=1,light.shadowCameraFar=400,light.shadowBias=-1e-4,light.shadowMapWidth=light.shadowMapHeight=1024,light.shadowDarkness=.001;var ambient=new THREE.AmbientLight(16777215),point=new THREE.PointLight(16777215,.3,1e3);point.shadowCameraLeft=-2,point.shadowCameraTop=-2,point.shadowCameraRight=2,point.shadowCameraBottom=2,point.shadowCameraNear=1,point.shadowCameraFar=1e3,point.shadowBias=-1e-4,point.shadowMapWidth=point.shadowMapHeight=256,point.shadowDarkness=.001,ambient.intensity=.9,scene.add(light),scene.add(ambient,point),point.position.x=1,point.position.y=3,point.position.z=5,loader=new THREE.JSONLoader,scene.add(mirrorCamera);var mesh,container,maxAnisotropy=renderer.getMaxAnisotropy(),floor_geometry=new THREE.BoxGeometry(10,.001,10),floor_material=new THREE.MeshBasicMaterial({envMap:mirrorCamera.renderTarget}),planeGeo=new THREE.PlaneBufferGeometry(100.1,100.1),groundMirror=new THREE.Mirror(renderer,camera,{clipBias:1,textureWidth:WIDTH,textureHeight:HEIGHT,color:15527148}),texture=groundMirror.material;texture.anisotropy=maxAnisotropy;var mirrorMesh=new THREE.Mesh(planeGeo,texture);mirrorMesh.add(groundMirror),mirrorMesh.rotateX(-Math.PI/2),scene.add(mirrorMesh);var currentTexture=0,images=[],textures=["branch1.png","branch.png","lotrec.jpg","starrynight.jpg","leopard.png","black.jpg","silver.jpg","abstract.jpg","wall.jpg","metal.jpg","wood.jpg","blood.jpg","blue.jpg","mermer.jpg","minecraft.png","second.jpg","greenmarble.jpg","first.jpg","musema.jpg"];for(i in textures){var image=new Image;image.src="assets/textures/"+textures[i],images.push(image)}var mainTexture=textures[currentTexture];texture.needsUpdate=!0;var loader1=new THREE.JSONLoader;loader.load("assets/models/christmas_tree_cycles.json",function(e,r){function t(e,r){return Math.random()*(r-e)+e}var a=new THREE.MeshPhongMaterial({map:THREE.ImageUtils.loadTexture("assets/textures/"+mainTexture),transparent:!0,opacity:1,side:THREE.DoubleSide,depthWrite:!1});mesh=new THREE.Mesh(e,a),scene.add(mesh);var o=Math.PI/180;Particle3D=function(e){THREE.Particle.call(this,e),this.velocity=new THREE.Vector3(0,(-.03),0),this.velocity.rotateX(t(-45,45)),this.velocity.rotateY(t(0,360)),this.gravity=new THREE.Vector3(0,0,0),this.drag=1},Particle3D.prototype=new THREE.Sprite,Particle3D.prototype.constructor=Particle3D,Particle3D.prototype.updatePhysics=function(){this.velocity.multiplyScalar(this.drag),this.velocity.add(this.gravity),this.position.add(this.velocity)},THREE.Vector3.prototype.rotateY=function(e){cosRY=Math.cos(e*o),sinRY=Math.sin(e*o);var r=this.z,t=this.x;this.x=t*cosRY+r*sinRY,this.z=t*-sinRY+r*cosRY},THREE.Vector3.prototype.rotateX=function(e){cosRY=Math.cos(e*o),sinRY=Math.sin(e*o);var r=this.z,t=this.y;this.y=t*cosRY+r*sinRY,this.z=t*-sinRY+r*cosRY},THREE.Vector3.prototype.rotateZ=function(e){cosRY=Math.cos(e*o),sinRY=Math.sin(e*o);var r=this.x,t=this.y;this.y=t*cosRY+r*sinRY,this.x=t*-sinRY+r*cosRY};var i,n=new Image;n.src="assets/textures/snowflake.png";for(var s=new THREE.SpriteMaterial({map:new THREE.ImageUtils.loadTexture("assets/textures/snowflake.png"),transparent:!0}),c=0;c<500;c++)i=new Particle3D(s),i.position.x=20*Math.random()-10,i.position.y=40*Math.random()-10,i.position.z=20*Math.random()-10,i.scale.x=i.scale.y=.05,scene.add(i),particles.push(i);floor=new THREE.Mesh(floor_geometry,floor_material),mirrorCamera.position=floor.position,floor.receiveShadow=!0,camera.lookAt(mesh.position),mesh.receiveShadow=!0,mesh.castShadow=!0,mesh.rotation.z=0,mesh.rotation.x=Math.PI/2,mesh.rotation.y=0,mesh.position.x=-1,mesh.position.z=-1,scene.add(floor),scene.fog=new THREE.FogExp2(10066431,25e-5),render()});